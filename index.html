<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GestÃ£o de Gastos</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<!-- Chart -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: radial-gradient(circle at top, #1a1a1a, #000);
  color: #fff;
  padding: 20px;
}

.container {
  max-width: 420px;
  margin: auto;
  background: #141414;
  padding: 22px;
  border-radius: 22px;
}

input, select, button {
  width: 100%;
  padding: 14px;
  margin-top: 12px;
  border-radius: 14px;
  border: none;
  background: #1f1f1f;
  color: #fff;
}

button {
  background: #fff;
  color: #000;
  font-weight: 600;
}

#dark-toggle {
  position: fixed;
  top: 16px;
  right: 16px;
  font-size: 22px;
  cursor: pointer;
}
</style>
</head>

<body>

<div id="dark-toggle">ðŸŒ™</div>

<div class="container">

<h2 style="text-align:center">ðŸ’° GestÃ£o de Gastos</h2>

<div id="login">
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Palavra-passe">
  <button id="loginBtn">Entrar / Criar conta</button>
</div>

<div id="app" style="display:none">
  <select id="mesSelecionado"></select>

  <input id="salario" type="number" placeholder="SalÃ¡rio mensal">

  <select id="cat"></select>
  <input id="desc" placeholder="DescriÃ§Ã£o">
  <input id="val" type="number" placeholder="Valor (â‚¬)">
  <button id="addBtn">Adicionar gasto</button>

  <div id="comparacao"></div>

  <h3>Gastos do mÃªs</h3>
  <div id="gastosLista"></div>

  <canvas id="grafico"></canvas>

  <button id="logoutBtn">Sair</button>
</div>

</div>

<script>
/* FIREBASE */
firebase.initializeApp({
  apiKey: "AIzaSyA53gz5pwnzSFx4alP2Gb6L7N3qAvXmMdU",
  authDomain: "controle-financeiro-fafd9.firebaseapp.com",
  projectId: "controle-financeiro-fafd9"
});

const auth = firebase.auth();
const db = firebase.firestore();

/* ELEMENTOS */
const loginDiv = document.getElementById("login");
const appDiv = document.getElementById("app");
const darkToggle = document.getElementById("dark-toggle");

/* DARK MODE */
darkToggle.onclick = () => {
  document.body.classList.toggle("dark");
  darkToggle.textContent =
    document.body.classList.contains("dark") ? "â˜€ï¸" : "ðŸŒ™";
};

/* LOGIN */
document.getElementById("loginBtn").onclick = () => {
  auth.signInWithEmailAndPassword(email.value, password.value)
    .catch(() =>
      auth.createUserWithEmailAndPassword(email.value, password.value)
    );
};

document.getElementById("logoutBtn").onclick = () => auth.signOut();

/* AUTH STATE */
auth.onAuthStateChanged(user => {
  if (user) {
    loginDiv.style.display = "none";
    appDiv.style.display = "block";
    renderMeses();
    renderCategorias();
  } else {
    loginDiv.style.display = "block";
    appDiv.style.display = "none";
  }
});

/* MESES */
function renderMeses() {
  mesSelecionado.innerHTML = "";
  const now = new Date();
  for (let i = 0; i < 12; i++) {
    const d = new Date(now.getFullYear(), now.getMonth() - i, 1);
    const opt = document.createElement("option");
    opt.value = `${d.getFullYear()}-${d.getMonth()}`;
    opt.textContent = d.toLocaleString("pt", { month: "long", year: "numeric" });
    mesSelecionado.appendChild(opt);
  }
}

/* CATEGORIAS */
const categorias = ["AlimentaÃ§Ã£o","Transporte","Renda","Lazer","Outros"];
function renderCategorias() {
  cat.innerHTML = "";
  categorias.forEach(c => {
    const o = document.createElement("option");
    o.textContent = c;
    cat.appendChild(o);
  });
}
</script>

</body>
</html>
